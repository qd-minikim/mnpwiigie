<!--pages/pagegoods/pagegoods.wxml-->

<import src="../../page/common/pages/pagegood/pagegood.wxml" />
<view class='container ' style="flex-direction:column;display:flex; ">
  <!-- 导航选择 -->
  <view wx:if="{{promotiontagArry.length>0}}" class='align-center view_1' style="flex-direction:row;display:flex;  ">
    <scroll-view class="view_1_scroll-view" scroll-x='true' scroll-into-view="target" scroll-with-animation="false">
      <view class='view_1_1' style='align-items:center;flex-direction:row;display:flex; '>

        <!-- 2018-11-19 导航分类指引暂只支持 -->
        <!-- <view wx:if="{{promotiontag==''}}" class='align-center view_select_style  view_select_height  view_select_color font-size-5'>
          <view class='align-center' style='width:{{promotiontagWidth}};'>全部</view>
        </view>
        <view bindtap='selectTag' data-tagcode='' wx:else class='align-center view_select_style  view_select_height font-size-5 '>
          <view class='align-center' style='width:{{promotiontagWidth}};'>全部</view>

        </view> -->

        <block wx:for="{{promotiontagArry}}" wx:for-index="index" wx:for-item="item" wx:key="*this">
          <view wx:for="{{promotiontagArry}}" wx:for-index="index" wx:for-item="item" wx:key="*this" class='align-center view_select_left font-size-5' style="flex-direction:column;;display:flex;height:100rpx">

            <view   wx:if="{{promotiontag==''}}" style='height:50%;width:100%;' class='align-center view_select_style  view_select_height  view_select_color font-size-5'>全部</view>
            <view wx:else bindtap='selectTag' data-tagcode='' style='height:50%;;width:100%;' class='align-center view_select_style  view_select_height font-size-5 '>全部</view>



            <view style="flex-direction:row;;display:flex;height:50%;">
              <block wx:for="{{item.children}}" wx:for-item="itemC" wx:key="trade" wx:for-index="indexC">

                <block wx:if="{{indexC==item.children.length-1}}">
                  <view wx:if="{{promotiontag==itemC.tag_code}}" class='align-center view_select_style  view_select_top view_select_color' style='width:{{promotiontagWidth}};'>
                    <text>{{itemC.tag_name}}</text>
                  </view>

                  <view wx:else bindtap='selectTag' data-tagcode='{{itemC.tag_code}}' class='align-center view_select_style  view_select_top' style='width:{{promotiontagWidth}};'>
                    <text>{{itemC.tag_name}}</text>
                  </view>

                </block>
                <block wx:else>
                  <view wx:if="{{promotiontag==itemC.tag_code}}" class='align-center view_select_style view_select_right view_select_top view-ellipsis-1 view_select_color' style='width:{{promotiontagWidth}};'>
                    <text>{{itemC.tag_name}}</text>
                  </view>
                  <view wx:else bindtap='selectTag' data-tagcode='{{itemC.tag_code}}' class='align-center view_select_style view_select_right view_select_top view-ellipsis-1  ' style='width:{{promotiontagWidth}};'>
                    <text>{{itemC.tag_name}}</text>
                  </view>
                </block>
              </block>
            </view>



          </view>
        </block>
      </view>

    </scroll-view>

  </view>

  <scroll-view style='height:{{scrollViewHeight}}px' scroll-y='true' scroll-into-view="target" scroll-with-animation="false" bindscroll="scroll" bindscrolltoupper="upper" bindscrolltolower="lower"
  lower-threshold='1200'  >

    <!-- <template is="pagegood" data="{{goodsArry,imageSize,goodsSelected}}" /> -->
     <block wx:for="{{goodsArry}}" wx:for-item="itemG"   wx:for-index="indexG" wx:key="index">
    <view wx:if="{{indexG>0}}" class="gap-bg" style="flex-direction:column;"></view>
    <view bindtap='goodShowDetail' data-upmarkid='{{itemG.upmarkid}}' data-requir='{{itemG.requirementid}}' id='{{indexG}}'>
      <view style='position:relative'>
        <image style='width:{{imageSize}}px;height:{{imageSize}}px' lazy-load='true' src='{{itemG.richtextcover}}'></image>

        <!-- 仅存 -->
        <view style='position:absolute;bottom:12.5%;border-top-right-radius:50px ;border-bottom-right-radius:50px;padding: 5rpx 10rpx' class='font-size-6 font-color-2 bg-8'>仅存{{itemG.keep_storage}}件</view>
      </view>
      <view class='font-size-3 view-ellipsis-1'>{{itemG.title}}</view>
      <view class='font-size-7  align-r-center' style='flex-direction:row;display:flex'>
        <view class='align-center'>
          <image style='width:28rpx;height:28rpx' src='/image/figure_1.png'></image>
        </view>
        <view>{{itemG.leavehoursname}}{{itemG.leavehours}}</view>

        <view class='font-color-2 bg-13' style='padding:0 10rpx;border-radius:20rpx'> {{itemG.merchant_brand_name}}</view>
      </view>
      <view style='flex-direction:row;display:flex'>

        <view wx:if="{{itemG.deal_type =='1' || itemG.deal_type =='2'||itemG.deal_type =='3'}}" class='align-c-center' style='flex-direction:column;display:flex; '>
          <view class='font-size-7  '>￥{{itemG.list_price}}</view>
          <view wx:if="{{itemG.deal_type =='2'}}" class='font-size-7 font-color-7  '>{{itemG.link_price_name}}:{{itemG.link_discount}}</view>
        </view>
        <view style="flex-direction:row;display:flex;flex:1; justify-content:flex-end;  ">

          <view class='align-center' style='position:relative'>
            <view class='align-center' style='position:absolute;right:95rpx'>
              <image wx:for="{{itemG.my_friends}}" wx:for-item="itemi" wx:key="*this" class="scroll-view-friend-image" src='{{itemi.friend_image_url}}'></image>
            </view>

            <block wx:if="{{itemG.deal_type=='0'}}">
              <view class='align-center scroll-view-figure4 bg-16 font-color-2 font-size-6 '>{{itemG.link_price_name}}</view>

            </block>
            <block wx:elif="{{itemG.deal_type=='3'}}">
            <!-- 零售 -->
              <block wx:if="{{itemG.keep_storage<=0}}">
                <view class='align-center scroll-view-figure4 bg-4 font-color-4 font-size-6 '>售罄</view>
              </block>
              <block wx:else>
                <view class='align-center scroll-view-figure4 bg-17 font-color-12 font-size-6 '>{{itemG.link_price_name}}</view>
              </block>
            </block>
            <block wx:else>
              <block wx:if="{{itemG.keep_storage<=0}}">
                <view class='align-center scroll-view-figure4 bg-4 font-color-4 font-size-6 '>售罄</view>
              </block>
              <block wx:else>
                <view class='align-center scroll-view-figure4 bg-16 font-color-2 font-size-6 '>{{itemG.link_price_name}}</view>
              </block>
            </block>


          </view>
        </view>
      </view>


    </view>

  </block>
  <block wx:if="{{goodsSelected && goodsArry.length==0}}">
    <view class='font-size-6 align-center' style='margin-top:5rpx '>
      还没有商品
    </view>
  </block>
  </scroll-view>
</view>